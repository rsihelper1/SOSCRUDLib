<script>

    // This is the official link, which has all User Permissions.  This is always linked to a working version
   // var script_url = "https://script.google.com/macros/s/AKfycbyNBMmZTmmRUnBnu-IRGwD106qlyqMPQ1qil5gr158/dev";

    // This is the private development link
    var script_url = "https://script.google.com/macros/s/AKfycby9T9ded3p0kK1yfP2TcwaIi-ttgOolbFEIyElgoqg/dev"

    // Make an AJAX call to Google Script
    function insert_value() {

        $("#re").css("visibility", "hidden");
        document.getElementById("loader").style.visibility = "visible";
        $('#mySpinner').addClass('spinner');

     var url = script_url + "?callback=ctrlq&name=" + $("#name").val() + "&id=" + $("#id").val() + "&address=" + $("#address").val() + 
     "&city=" + $("#city").val() + "&state=" + $("#state").val() + "&zip=" + $("#zip").val() +"&action=insert";


        var request = jQuery.ajax({
            crossDomain: true,
            url: url,
            method: "GET",
            dataType: "jsonp"
        });
    }







    function update_value() {
        $("#re").css("visibility", "hidden");
        document.getElementById("loader").style.visibility = "visible";


        var id1 = $("#id").val();
        var name = $("#name").val();



        var url = script_url + "?callback=ctrlq&name=" + name + "&id=" + id1 + "&action=update";


        var request = jQuery.ajax({
            crossDomain: true,
            url: url,
            method: "GET",
            dataType: "jsonp"
        });


    }





    function delete_value() {
        $("#re").css("visibility", "hidden");
        document.getElementById("loader").style.visibility = "visible";
        $('#mySpinner').addClass('spinner');
        var id1 = $("#id").val();
        var name = $("#name").val();


        var url = script_url + "?callback=ctrlq&name=" + name + "&id=" + id1 + "&action=delete";


        var request = jQuery.ajax({
            crossDomain: true,
            url: url,
            method: "GET",
            dataType: "jsonp"
        });

    }




    // print the returned data
    function ctrlq(e) {


        $("#re").html(e.result);
        $("#re").css("visibility", "visible");
        read_value();

    }




    function read_value() {

        $("#re").css("visibility", "hidden");

        document.getElementById("loader").style.visibility = "visible";
        var url = script_url + "?action=read";
        var request = jQuery.ajax({
            crossDomain: true,
            url: url,
            method: "GET",
            dataType: "jsonp"
        }).done(function (json) { PrintResults(json) });
    }

    function search_value() {

        $("#re").css("visibility", "hidden");

        var searchby = $("#searchby").val();
        var searchtext = $("#searchtext").val();

        document.getElementById("loader").style.visibility = "visible";
        var url = script_url + "?action=search&searchby=" + searchby + "&searchtext=" + searchtext;
        var request = jQuery.ajax({
            crossDomain: true,
            url: url,
            method: "GET",
            dataType: "jsonp"
        }).done(function (json) { PrintResults(json) });
    }

    function PrintResults(json) {

            // CREATE DYNAMIC TABLE.
            var table = document.createElement("table");

            table.setAttribute('class','table table-bordered table-condensed table-hover');
             table.setAttribute('width','400px');
            
            
            var header = table.createTHead();
            var row = header.insertRow(0);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            var cell4 = row.insertCell(3);
            var cell5 = row.insertCell(4);
            var cell6 = row.insertCell(5);
            var cell7 = row.insertCell(6);
            var cell8 = row.insertCell(7);
             var cell9 = row.insertCell(8);
            
            cell1.innerHTML = "<b>ID</b>";
            cell2.innerHTML = "<b>Name</b>";
            cell3.innerHTML = "<b>Address</b>";
            cell4.innerHTML = "<b>City</b>";
            cell5.innerHTML = "<b>State</b>";
            cell6.innerHTML = "<b>Zip</b>";
             cell7.innerHTML = "<b>Edit</b>"; 
             cell8.innerHTML = "<b>Delete</b>";
            cell9.innerHTML = "<b>View</b>";
            
            var tblebody = table.createTBody();
            // ADD JSON DATA TO THE TABLE AS ROWS.
            for (var i = 0; i < json.records.length; i++) {
               
                tr = tblebody.insertRow(-1);
                var tabCell = tr.insertCell(-1);
                tabCell.innerHTML = json.records[i].ID;
                tabCell = tr.insertCell(-1);
                tabCell.innerHTML = json.records[i].NAME;
                tabCell = tr.insertCell(-1);
                tabCell.innerHTML = json.records[i].ADDRESS;
                tabCell = tr.insertCell(-1);
                tabCell.innerHTML = json.records[i].CITY;
                tabCell = tr.insertCell(-1);
                tabCell.innerHTML = json.records[i].STATE;
                tabCell = tr.insertCell(-1);
                tabCell.innerHTML = json.records[i].ZIP;
               
               
               tabCell = tr.insertCell(-1); 
             var editBtn=document.createElement("button")
      editBtn.innerHTML="Edit"
      editBtn.setAttribute("class" , "btn btn-sm btn-primary")
      editBtn.setAttribute("onclick" , "");
  tabCell.appendChild(editBtn);
  
    tabCell = tr.insertCell(-1);
      var deletebtn=document.createElement("button")
      deletebtn.innerHTML="Delete"
      deletebtn.setAttribute("class" , "btn btn-sm btn-danger")
      deletebtn.setAttribute("onclick" , "")
      tabCell.appendChild(deletebtn); 
      
       tabCell = tr.insertCell(-1);
      var viewbtn=document.createElement("button")
      viewbtn.innerHTML="View Profile"
      viewbtn.setAttribute("class" , "btn btn-sm btn-primary")
      viewbtn.setAttribute("onclick" , "")
      tabCell.appendChild(viewbtn);
   
       }


            // FINALLY ADD THE NEWLY CREATED TABLE WITH JSON DATA TO A CONTAINER.
            var divContainer = document.getElementById("showData");
            divContainer.innerHTML = "";
            divContainer.appendChild(table);
            document.getElementById("loader").style.visibility = "hidden";
            $("#re").css("visibility", "visible");
        }
</script>